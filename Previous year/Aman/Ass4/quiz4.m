clc;

n = 20;
dofreg = n  - 5;
doferr = n - 1 - dofreg;
alpha = 0.16192785;

index = 2;
data = [
0 0 0 0 5.0863786;
0.10238831 0.15779825 0.1295477 0.12545552 4.1387271;
0.19140958 0.15285829 0.23860801 0.14498167 2.4596102;
0.53205234 0.42109765 0.34375291 0.23943447 2.1135793;
0.61797427 0.73245038 0.29613421 0.60937805 3.9742782;
0.78517263 0.49899952 0.43214538 0.51806871 2.408572;
0.6723332 0.44765108 0.40204486 0.72894899 1.4505086;
0.94443491 1.2320344 1.1007514 0.8539727 9.765127;
1.0429299 1.3862292 1.2322851 0.83590056 12.946254;
1.3493166 1.7736302 1.3782985 1.0713133 30.813514;
1.7087647 1.3966713 0.64094685 0.82208691 6.4568235;
0.67056588 1.0908901 1.1759444 0.96973399 10.015336;
1.8606225 1.7561738 0.99928418 2.1454692 29.363834;
1.1369613 2.5323494 2.1799466 1.5698914 126.27154;
1.8716845 2.3571824 1.955722 0.9550505 127.90615;
1.5638995 1.4734387 1.1293908 0.75915186 18.850147;
2.5820059 2.7447182 1.2149592 2.9590576 124.14695;
1.5127518 1.4664672 3.2843459 3.2150848 375.35593;
3.5606504 2.6006889 2.4554723 2.5306493 771.75451;
1.3716858 3.6006343 3.2096727 3.2536739 760.09549;
];


X = zeros(n,p);
Y = zeros(n,1);

for i=1:n
    Y(i, 1) = data(i, 5);
    X(i, 1) = 1;
    X(i, 2) = data(i, 1) * data(i, 4) * data(i, 1) * data(i, 3) * data(i, 1);
    X(i, 3) = data(i, 2) * data(i, 3) * data(i, 4) * data(i, 1) * data(i, 3);
    X(i, 4) = data(i, 3) * data(i, 3) * data(i, 2) * data(i, 3) * data(i, 1);
    X(i, 5) = data(i, 4) * data(i, 4) * data(i, 1) * data(i, 2) * data(i, 4);
end

beta_cap = ((X' * X)^-1) * (X') * Y;
disp(beta_cap);

Y_cap = X * beta_cap;

Yerrs = (Y - Y_cap).^2;
SSE = 0;

for i = 1:20
    SSE = SSE + (Y(i) - Y_cap(i))^2;
end

disp(SSE);

SST = sum(Y.^2) - sum(Y)^2 / n;
SSR = SST - SSE;
Rsquare = SSR / SST;

disp(SSR);
disp(SSE);
disp(Rsquare);

covbeta = (SSE / doferr) * (X' * X)^-1;
betarange = zeros(5, 2);
betarange(:, 1) = beta_cap - abs(tinv(alpha/2, doferr)) * sqrt(diag(covbeta));
betarange(:, 1) = beta_cap + abs(tinv(alpha/2, doferr)) * sqrt(diag(covbeta));

disp(betarange);